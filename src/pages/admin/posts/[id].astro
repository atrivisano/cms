---
import Layout from '../../../layouts/Layout.astro';
import EditPost from './edit.vue';
import AuthMiddleware from '../../../components/AuthMiddleware.vue';
import { supabase } from '../../../lib/supabase';

export async function getStaticPaths() {
  const { data: posts } = await supabase
    .from('posts')
    .select('id');

  return posts?.map(post => ({
    params: { id: post.id },
  })) || [];
}

const { id } = Astro.params;
---

<Layout title="Edit Post - ModernCMS">
  <AuthMiddleware client:load requireAuth={true}>
    <EditPost client:load postId={id} />
  </AuthMiddleware>
</Layout>